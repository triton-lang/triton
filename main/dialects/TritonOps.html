

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TritonOps &mdash; Triton  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TritonNvidiaGPUOps" href="TritonNvidiaGPUOps.html" />
    <link rel="prev" title="GluonOps" href="GluonOps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Triton
              <img src="https://cdn.openai.com/triton/assets/triton-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.html">triton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.language.html">triton.language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.testing.html">triton.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton-semantics.html">Triton Semantics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Triton MLIR Dialects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dialects.html">Triton MLIR Dialects and Ops</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GluonDialect.html">‘gluon’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUDialect.html">‘ttng’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUDialect.html">‘ttg’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonDialect.html">‘proton’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUDialect.html">‘nvgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonGPUDialect.html">‘proton_gpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVWSDialect.html">‘nvws’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonDialect.html">‘tt’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentDialect.html">‘tti’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUDialect.html">‘amdgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentOps.html">TritonInstrumentOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUOps.html">TritonAMDGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUOps.html">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonGPUOps.html">ProtonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonOps.html">ProtonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="GluonOps.html">GluonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tt-call-triton-callop"><code class="docutils literal notranslate"><span class="pre">tt.call</span></code> (triton::CallOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operands">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-func-triton-funcop"><code class="docutils literal notranslate"><span class="pre">tt.func</span></code> (triton::FuncOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Attributes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-return-triton-returnop"><code class="docutils literal notranslate"><span class="pre">tt.return</span></code> (triton::ReturnOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-addptr-triton-addptrop"><code class="docutils literal notranslate"><span class="pre">tt.addptr</span></code> (triton::AddPtrOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-advance-triton-advanceop"><code class="docutils literal notranslate"><span class="pre">tt.advance</span></code> (triton::AdvanceOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-assert-triton-assertop"><code class="docutils literal notranslate"><span class="pre">tt.assert</span></code> (triton::AssertOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-atomic-cas-triton-atomiccasop"><code class="docutils literal notranslate"><span class="pre">tt.atomic_cas</span></code> (triton::AtomicCASOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-atomic-rmw-triton-atomicrmwop"><code class="docutils literal notranslate"><span class="pre">tt.atomic_rmw</span></code> (triton::AtomicRMWOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-bitcast-triton-bitcastop"><code class="docutils literal notranslate"><span class="pre">tt.bitcast</span></code> (triton::BitcastOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-broadcast-triton-broadcastop"><code class="docutils literal notranslate"><span class="pre">tt.broadcast</span></code> (triton::BroadcastOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-cat-triton-catop"><code class="docutils literal notranslate"><span class="pre">tt.cat</span></code> (triton::CatOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id19">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-clampf-triton-clampfop"><code class="docutils literal notranslate"><span class="pre">tt.clampf</span></code> (triton::ClampFOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id21">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-descriptor-gather-triton-descriptorgatherop"><code class="docutils literal notranslate"><span class="pre">tt.descriptor_gather</span></code> (triton::DescriptorGatherOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-descriptor-load-triton-descriptorloadop"><code class="docutils literal notranslate"><span class="pre">tt.descriptor_load</span></code> (triton::DescriptorLoadOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id26">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-descriptor-reduce-triton-descriptorreduceop"><code class="docutils literal notranslate"><span class="pre">tt.descriptor_reduce</span></code> (triton::DescriptorReduceOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id29">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-descriptor-scatter-triton-descriptorscatterop"><code class="docutils literal notranslate"><span class="pre">tt.descriptor_scatter</span></code> (triton::DescriptorScatterOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id31">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-descriptor-store-triton-descriptorstoreop"><code class="docutils literal notranslate"><span class="pre">tt.descriptor_store</span></code> (triton::DescriptorStoreOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id32">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-dot-triton-dotop"><code class="docutils literal notranslate"><span class="pre">tt.dot</span></code> (triton::DotOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id33">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id35">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-dot-scaled-triton-dotscaledop"><code class="docutils literal notranslate"><span class="pre">tt.dot_scaled</span></code> (triton::DotScaledOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id36">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id38">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-elementwise-inline-asm-triton-elementwiseinlineasmop"><code class="docutils literal notranslate"><span class="pre">tt.elementwise_inline_asm</span></code> (triton::ElementwiseInlineAsmOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id39">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-expand-dims-triton-expanddimsop"><code class="docutils literal notranslate"><span class="pre">tt.expand_dims</span></code> (triton::ExpandDimsOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id42">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id43">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id44">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-extern-elementwise-triton-externelementwiseop"><code class="docutils literal notranslate"><span class="pre">tt.extern_elementwise</span></code> (triton::ExternElementwiseOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id45">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id46">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id47">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-fp-to-fp-triton-fptofpop"><code class="docutils literal notranslate"><span class="pre">tt.fp_to_fp</span></code> (triton::FpToFpOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id48">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id49">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id50">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-gather-triton-gatherop"><code class="docutils literal notranslate"><span class="pre">tt.gather</span></code> (triton::GatherOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id51">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id52">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id53">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-get-num-programs-triton-getnumprogramsop"><code class="docutils literal notranslate"><span class="pre">tt.get_num_programs</span></code> (triton::GetNumProgramsOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id54">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id55">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-get-program-id-triton-getprogramidop"><code class="docutils literal notranslate"><span class="pre">tt.get_program_id</span></code> (triton::GetProgramIdOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id56">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id57">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-histogram-triton-histogramop"><code class="docutils literal notranslate"><span class="pre">tt.histogram</span></code> (triton::HistogramOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id58">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id59">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-int-to-ptr-triton-inttoptrop"><code class="docutils literal notranslate"><span class="pre">tt.int_to_ptr</span></code> (triton::IntToPtrOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id60">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id61">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-join-triton-joinop"><code class="docutils literal notranslate"><span class="pre">tt.join</span></code> (triton::JoinOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id62">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id63">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-load-triton-loadop"><code class="docutils literal notranslate"><span class="pre">tt.load</span></code> (triton::LoadOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id64">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id65">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id66">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-make-range-triton-makerangeop"><code class="docutils literal notranslate"><span class="pre">tt.make_range</span></code> (triton::MakeRangeOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id67">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id68">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-make-tensor-descriptor-triton-maketensordescop"><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_descriptor</span></code> (triton::MakeTensorDescOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id69">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id70">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id71">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-make-tensor-ptr-triton-maketensorptrop"><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_ptr</span></code> (triton::MakeTensorPtrOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id72">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id73">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-map-elementwise-triton-mapelementwiseop"><code class="docutils literal notranslate"><span class="pre">tt.map_elementwise</span></code> (triton::MapElementwiseOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id75">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id76">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id77">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-map-elementwise-return-triton-mapelementwisereturnop"><code class="docutils literal notranslate"><span class="pre">tt.map_elementwise.return</span></code> (triton::MapElementwiseReturnOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id78">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-mulhiui-triton-mulhiuiop"><code class="docutils literal notranslate"><span class="pre">tt.mulhiui</span></code> (triton::MulhiUIOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id79">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id80">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-precise-divf-triton-precisedivfop"><code class="docutils literal notranslate"><span class="pre">tt.precise_divf</span></code> (triton::PreciseDivFOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id81">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id82">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-precise-sqrt-triton-precisesqrtop"><code class="docutils literal notranslate"><span class="pre">tt.precise_sqrt</span></code> (triton::PreciseSqrtOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id83">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id84">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-print-triton-printop"><code class="docutils literal notranslate"><span class="pre">tt.print</span></code> (triton::PrintOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id85">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id86">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-ptr-to-int-triton-ptrtointop"><code class="docutils literal notranslate"><span class="pre">tt.ptr_to_int</span></code> (triton::PtrToIntOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id87">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id88">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-reduce-triton-reduceop"><code class="docutils literal notranslate"><span class="pre">tt.reduce</span></code> (triton::ReduceOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id89">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id90">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id91">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-reduce-return-triton-reducereturnop"><code class="docutils literal notranslate"><span class="pre">tt.reduce.return</span></code> (triton::ReduceReturnOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id92">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-reshape-triton-reshapeop"><code class="docutils literal notranslate"><span class="pre">tt.reshape</span></code> (triton::ReshapeOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id93">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id94">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id95">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-scan-triton-scanop"><code class="docutils literal notranslate"><span class="pre">tt.scan</span></code> (triton::ScanOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id96">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id97">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id98">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-scan-return-triton-scanreturnop"><code class="docutils literal notranslate"><span class="pre">tt.scan.return</span></code> (triton::ScanReturnOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id99">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-splat-triton-splatop"><code class="docutils literal notranslate"><span class="pre">tt.splat</span></code> (triton::SplatOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id100">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id101">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-split-triton-splitop"><code class="docutils literal notranslate"><span class="pre">tt.split</span></code> (triton::SplitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id102">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id103">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-store-triton-storeop"><code class="docutils literal notranslate"><span class="pre">tt.store</span></code> (triton::StoreOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id104">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id105">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tt-trans-triton-transop"><code class="docutils literal notranslate"><span class="pre">tt.trans</span></code> (triton::TransOp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-note-on-encodings">Implementation note on encodings:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id106">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id107">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id108">Results:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tt-unsplat-triton-unsplatop"><code class="docutils literal notranslate"><span class="pre">tt.unsplat</span></code> (triton::UnsplatOp)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUOps.html">TritonNvidiaGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUOps.html">NVGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVWSOps.html">NVWSOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-1/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-2/related-work.html">Related Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-3/debugging.html">Debugging Triton</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Triton</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dialects.html">Triton MLIR Dialects and Ops</a></li>
      <li class="breadcrumb-item active">TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dialects/TritonOps.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tritonops">
<h1>TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --><a class="headerlink" href="#tritonops" title="Link to this heading">¶</a></h1>
<section id="tt-call-triton-callop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.call</span></code> (triton::CallOp)<a class="headerlink" href="#tt-call-triton-callop" title="Link to this heading">¶</a></h2>
<p><em>Call operation</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.call` $callee `(` $operands `)` attr-dict `:` functional-type($operands, results)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tt.call</span></code> operation represents a direct call to a function that is
within the same symbol scope as the call. The operands and result types of
the call must match the specified function type. The callee is encoded as a
symbol reference attribute named “callee”.</p>
<p>Example:</p>
<div class="highlight-mlir notranslate"><div class="highlight"><pre><span></span>%2 = tt.call @my_add(%0, %1) : (f32, f32) -&gt; f32
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArgAndResultAttrsOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">CallOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">SymbolUserOpInterface</span></code></p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>callee</code></td><td>::mlir::FlatSymbolRefAttr</td><td>flat symbol reference attribute</td></tr>
<tr><td><code>arg_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<tr><td><code>res_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
</table>
</section>
<section id="operands">
<h3>Operands:<a class="headerlink" href="#operands" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">operands</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="results">
<h3>Results:<a class="headerlink" href="#results" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>«unnamed»</p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-func-triton-funcop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.func</span></code> (triton::FuncOp)<a class="headerlink" href="#tt-func-triton-funcop" title="Link to this heading">¶</a></h2>
<p><em>An operation with a name containing a single <code class="docutils literal notranslate"><span class="pre">SSACFG</span></code> region</em></p>
<p>Operations within the function cannot implicitly capture values defined
outside of the function, i.e. Functions are <code class="docutils literal notranslate"><span class="pre">IsolatedFromAbove</span></code>. All
external references must use function arguments or attributes that establish
a symbolic connection (e.g. symbols referenced by name via a string
attribute like SymbolRefAttr). An external function declaration (used when
referring to a function declared in some other module) has no body. While
the MLIR textual form provides a nice inline syntax for function arguments,
they are internally represented as “block arguments” to the first block in
the region.</p>
<p>Only dialect attribute names may be specified in the attribute dictionaries
for function arguments, results, or the function itself.</p>
<p>Example:</p>
<div class="highlight-mlir notranslate"><div class="highlight"><pre><span></span>// External function definitions.
tt.func @abort()
tt.func @scribble(i32, i64, memref&lt;? x 128 x f32, #layout_map0&gt;) -&gt; f64

// A function that returns its argument twice:
tt.func @count(%x: i64) -&gt; (i64, i64)
  attributes {fruit: &quot;banana&quot;} {
  return %x, %x: i64, i64
}

// A function with an argument attribute
tt.func @example_fn_arg(%x: i32 {swift.self = unit})

// A function with a result attribute
tt.func @example_fn_result() -&gt; (f64 {dialectName.attrName = 0 : i64})

// A function with an attribute
tt.func @example_fn_attr() attributes {dialectName.attrName = false}
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AffineScope</span></code>, <code class="docutils literal notranslate"><span class="pre">AutomaticAllocationScope</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;ModuleOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">IsolatedFromAbove</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArgAndResultAttrsOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">CallableOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">FunctionOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">OpAsmOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">Symbol</span></code></p>
<section id="id1">
<h3>Attributes:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sym_name</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>function_type</code></td><td>::mlir::TypeAttr</td><td>type attribute of function type</td></tr>
<tr><td><code>sym_visibility</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>arg_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
<tr><td><code>res_attrs</code></td><td>::mlir::ArrayAttr</td><td>Array of dictionary attributes</td></tr>
</table>
</section>
</section>
<section id="tt-return-triton-returnop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.return</span></code> (triton::ReturnOp)<a class="headerlink" href="#tt-return-triton-returnop" title="Link to this heading">¶</a></h2>
<p><em>Function return operation</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.return` attr-dict ($srcs^ `:` type($srcs))?
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tt.return</span></code> operation represents a return operation within a function.
The operation takes variable number of operands and produces no results.
The operand number and types must match the signature of the function
that contains the operation.</p>
<p>Example:</p>
<div class="highlight-mlir notranslate"><div class="highlight"><pre><span></span>tt.func @foo() : (i32, f8) {
  ...
  tt.return %0, %1 : i32, f8
}
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;FuncOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id2">
<h3>Operands:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">srcs</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-addptr-triton-addptrop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.addptr</span></code> (triton::AddPtrOp)<a class="headerlink" href="#tt-addptr-triton-addptrop" title="Link to this heading">¶</a></h2>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.addptr` $ptr `,` $offset attr-dict `:` type($result) `,` type($offset)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id3">
<h3>Operands:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">offset</span></code></p></td>
<td><p>integer or ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id4">
<h3>Results:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-advance-triton-advanceop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.advance</span></code> (triton::AdvanceOp)<a class="headerlink" href="#tt-advance-triton-advanceop" title="Link to this heading">¶</a></h2>
<p><em>Advance a tensor pointer by offsets</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.advance` $ptr `,` `[` $offsets `]` attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id5">
<h3>Operands:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">offsets</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id6">
<h3>Results:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-assert-triton-assertop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.assert</span></code> (triton::AssertOp)<a class="headerlink" href="#tt-assert-triton-assertop" title="Link to this heading">¶</a></h2>
<p><em>Device-side assert, as in CUDA for correctness checking</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.assert` $condition `,` $message attr-dict `:` type($condition)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tt.assert</span></code> takes a condition tensor and a message string.
If the condition is false, the message is printed, and the program is aborted.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{MemoryEffects::Write</span> <span class="pre">on</span> <span class="pre">::mlir::triton::GlobalMemory}</span></code></p>
<section id="id7">
<h3>Attributes:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>message</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
</table>
</section>
<section id="id8">
<h3>Operands:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">condition</span></code></p></td>
<td><p>1-bit signless integer or tensor of 1-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-atomic-cas-triton-atomiccasop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.atomic_cas</span></code> (triton::AtomicCASOp)<a class="headerlink" href="#tt-atomic-cas-triton-atomiccasop" title="Link to this heading">¶</a></h2>
<p><em>Atomic cas</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.atomic_cas` $sem `,` $scope `,` $ptr `,` $cmp `,` $val attr-dict `:`
              functional-type(operands, $result)
</pre></div>
</div>
<p>compare $cmp with data $old at location $ptr,</p>
<p>if $old == $cmp, store $val to $ptr,</p>
<p>else store $old to $ptr,</p>
<p>return $old</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id9">
<h3>Attributes:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>sem</code></td><td>::mlir::triton::MemSemanticAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4</td></tr>
<tr><td><code>scope</code></td><td>::mlir::triton::MemSyncScopeAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
</table>
</section>
<section id="id10">
<h3>Operands:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">cmp</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">val</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id11">
<h3>Results:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-atomic-rmw-triton-atomicrmwop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.atomic_rmw</span></code> (triton::AtomicRMWOp)<a class="headerlink" href="#tt-atomic-rmw-triton-atomicrmwop" title="Link to this heading">¶</a></h2>
<p><em>Atomic rmw</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.atomic_rmw` $atomic_rmw_op `,` $sem `,` $scope `,` $ptr `,` $val (`,` $mask^)?  attr-dict `:`
              functional-type(operands, $result)
</pre></div>
</div>
<p>load data at $ptr, do $rmw_op with $val, and store result to $ptr.</p>
<p>return old value at $ptr</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id12">
<h3>Attributes:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>atomic_rmw_op</code></td><td>::mlir::triton::RMWOpAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</td></tr>
<tr><td><code>sem</code></td><td>::mlir::triton::MemSemanticAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4</td></tr>
<tr><td><code>scope</code></td><td>::mlir::triton::MemSyncScopeAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
</table>
</section>
<section id="id13">
<h3>Operands:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">val</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>1-bit signless integer or ranked tensor of 1-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id14">
<h3>Results:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-bitcast-triton-bitcastop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.bitcast</span></code> (triton::BitcastOp)<a class="headerlink" href="#tt-bitcast-triton-bitcastop" title="Link to this heading">¶</a></h2>
<p><em>Cast between types of the same bitwidth</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.bitcast` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id15">
<h3>Operands:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id16">
<h3>Results:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-broadcast-triton-broadcastop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.broadcast</span></code> (triton::BroadcastOp)<a class="headerlink" href="#tt-broadcast-triton-broadcastop" title="Link to this heading">¶</a></h2>
<p><em>Broadcast a tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.broadcast` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>For a given tensor, broadcast changes one or more dimensions with size 1
to a new size, e.g. tensor&lt;1x32x1xf32&gt; -&gt; tensor&lt;2x32x4xf32&gt;.  You cannot
change the size of a non-1 dimension.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id17">
<h3>Operands:<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id18">
<h3>Results:<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-cat-triton-catop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.cat</span></code> (triton::CatOp)<a class="headerlink" href="#tt-cat-triton-catop" title="Link to this heading">¶</a></h2>
<p><em>Concatenate 2 tensors</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.cat` $lhs `,` $rhs attr-dict `:` type($lhs) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">SameTypeOperands</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id19">
<h3>Operands:<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">lhs</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">rhs</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id20">
<h3>Results:<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-clampf-triton-clampfop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.clampf</span></code> (triton::ClampFOp)<a class="headerlink" href="#tt-clampf-triton-clampfop" title="Link to this heading">¶</a></h2>
<p><em>Clamp operation for floating point types</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.clampf` $x `,` $min `,` $max `,` `propagateNan` `=` $propagateNan attr-dict `:` type($result)
</pre></div>
</div>
<p>Clamp operation for floating point types.</p>
<p>The operation takes three arguments: x, min, and max. It returns a tensor of the same shape as x with its values clamped to the range [min, max].</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id21">
<h3>Attributes:<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>propagateNan</code></td><td>::mlir::triton::PropagateNanAttr</td><td>allowed 32-bit signless integer cases: 0, 65535</td></tr>
</table>
</section>
<section id="id22">
<h3>Operands:<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">min</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">max</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id23">
<h3>Results:<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-descriptor-gather-triton-descriptorgatherop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.descriptor_gather</span></code> (triton::DescriptorGatherOp)<a class="headerlink" href="#tt-descriptor-gather-triton-descriptorgatherop" title="Link to this heading">¶</a></h2>
<p><em>Gather multiple rows from a descriptor into a single tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.descriptor_gather` $desc `[` $x_offsets `,` $y_offset `]`
              attr-dict `:` functional-type(operands, results)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tt.descriptor_gather</span></code> op will be lowered to NVIDIA TMA
gather operations on targets that support it.</p>
<p><code class="docutils literal notranslate"><span class="pre">desc_ptr</span></code> is a pointer to the TMA descriptor allocated in global memory.
The descriptor block must have 1 row and the indices must be a 1D tensor.
Accordingly, the result is a 2D tensor multiple rows.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code></p>
<section id="id24">
<h3>Operands:<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x_offsets</span></code></p></td>
<td><p>ranked tensor of 32-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">y_offset</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id25">
<h3>Results:<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-descriptor-load-triton-descriptorloadop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.descriptor_load</span></code> (triton::DescriptorLoadOp)<a class="headerlink" href="#tt-descriptor-load-triton-descriptorloadop" title="Link to this heading">¶</a></h2>
<p><em>Load from descriptor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.descriptor_load` $desc `[` $indices `]`
              oilist(
              `cacheModifier` `=` $cache |
              `evictionPolicy` `=` $evict
              )
              attr-dict `:` qualified(type($desc)) `-&gt;` type($result)
</pre></div>
</div>
<p>This operation will be lowered to Nvidia TMA load operation on targets supporting it.
<code class="docutils literal notranslate"><span class="pre">desc</span></code> is a tensor descriptor object.
The destination tensor type and shape must match the descriptor otherwise the result is undefined.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code></p>
<section id="id26">
<h3>Attributes:<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7</td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
</table>
</section>
<section id="id27">
<h3>Operands:<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">indices</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id28">
<h3>Results:<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-descriptor-reduce-triton-descriptorreduceop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.descriptor_reduce</span></code> (triton::DescriptorReduceOp)<a class="headerlink" href="#tt-descriptor-reduce-triton-descriptorreduceop" title="Link to this heading">¶</a></h2>
<p><em>Performs a reducing store operation based on a descriptor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.descriptor_reduce` $kind `,` $desc `[` $indices `]` `,` $src
              attr-dict `:` qualified(type($desc)) `,` type($src)
</pre></div>
</div>
<p>This operation will be lowered to Nvidia TMA store operation on targets supporting it.
<code class="docutils literal notranslate"><span class="pre">desc</span></code> is a tensor descriptor object.
The shape and types of <code class="docutils literal notranslate"><span class="pre">src</span></code> must match the descriptor otherwise the result is undefined.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">TT_DescriptorStoreLikeOpInterface</span></code></p>
<section id="id29">
<h3>Attributes:<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>kind</code></td><td>::mlir::triton::DescriptorReduceKindAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7, 8</td></tr>
</table>
</section>
<section id="id30">
<h3>Operands:<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">indices</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-descriptor-scatter-triton-descriptorscatterop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.descriptor_scatter</span></code> (triton::DescriptorScatterOp)<a class="headerlink" href="#tt-descriptor-scatter-triton-descriptorscatterop" title="Link to this heading">¶</a></h2>
<p><em>Scatter multiple rows to a descriptor from a single tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.descriptor_scatter` $desc `[` $x_offsets `,` $y_offset `]` `,` $src
              attr-dict `:` type(operands)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tt.descriptor_scatter</span></code> op will be lowered to NVIDIA TMA
scatter operations on targets that support it.</p>
<p><code class="docutils literal notranslate"><span class="pre">desc_ptr</span></code> is a pointer to the TMA descriptor allocated in global memory.
The descriptor block must have 1 row and the indices must be a 1D tensor.
Accordingly, the result is a 2D tensor multiple rows.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">TT_DescriptorStoreLikeOpInterface</span></code></p>
<section id="id31">
<h3>Operands:<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x_offsets</span></code></p></td>
<td><p>ranked tensor of 32-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">y_offset</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-descriptor-store-triton-descriptorstoreop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.descriptor_store</span></code> (triton::DescriptorStoreOp)<a class="headerlink" href="#tt-descriptor-store-triton-descriptorstoreop" title="Link to this heading">¶</a></h2>
<p><em>Store value based on descriptor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.descriptor_store` $desc `[` $indices `]` `,` $src
              attr-dict `:` qualified(type($desc)) `,` type($src)
</pre></div>
</div>
<p>This operation will be lowered to Nvidia TMA store operation on targets supporting it.
<code class="docutils literal notranslate"><span class="pre">desc</span></code> is a tensor descriptor object.
The shape and types of <code class="docutils literal notranslate"><span class="pre">src</span></code> must match the descriptor otherwise the result is undefined.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">TT_DescriptorStoreLikeOpInterface</span></code></p>
<section id="id32">
<h3>Operands:<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">indices</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-dot-triton-dotop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.dot</span></code> (triton::DotOp)<a class="headerlink" href="#tt-dot-triton-dotop" title="Link to this heading">¶</a></h2>
<p><em>Dot</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.dot` $a`,` $b`,` $c (`,` `inputPrecision` `=` $inputPrecision^)? attr-dict `:`
              type($a) `*` type($b) `-&gt;` type($d)
</pre></div>
</div>
<p>$d = matrix_multiply($a, $b) + $c. $inputPrecision describes how to exercise the TC
when the inputs are f32. It can be one of: tf32, tf32x3, ieee, bf16x3, bf16x6.
tf32: use TC with tf32 ops.
tf32x3: implement the 3xTF32 trick. For more info see the pass in F32DotTC.cpp
bf16x3: implement the 3xBF16 trick. For more info see the pass in F32DotTC.cpp
bf16x6: implement the 6xBF16 trick. For more info see the pass in F32DotTC.cpp
ieee: don’t use TC, implement dot in software.
If the GPU does not have Tensor cores or the inputs are not f32, this flag is ignored.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">DotOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id33">
<h3>Attributes:<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>inputPrecision</code></td><td>::mlir::triton::InputPrecisionAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2, 3, 4</td></tr>
<tr><td><code>maxNumImpreciseAcc</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id34">
<h3>Operands:<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">a</span></code></p></td>
<td><p>ranked tensor of floating-point or integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p>ranked tensor of floating-point or integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">c</span></code></p></td>
<td><p>ranked tensor of floating-point or integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id35">
<h3>Results:<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">d</span></code></p></td>
<td><p>ranked tensor of floating-point or integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-dot-scaled-triton-dotscaledop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.dot_scaled</span></code> (triton::DotScaledOp)<a class="headerlink" href="#tt-dot-scaled-triton-dotscaledop" title="Link to this heading">¶</a></h2>
<p><em>Dot_scaled</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.dot_scaled` $a (`scale` $a_scale^)? `,` $b (`scale` $b_scale^)? `,` $c
              `lhs` `=` $a_elem_type `rhs` `=` $b_elem_type attr-dict
              `:` type($a) (`,` type($a_scale)^)? `*` type($b) (`,` type($b_scale)^)? `-&gt;` type($d)
</pre></div>
</div>
<p>$d = matrix_multiply(scale($a, $a_scale), scale($b, $b_scale)) + $c.
Where scale(x, s) is a function that applies the scale per block following microscaling spec.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">DotOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id36">
<h3>Attributes:<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>a_elem_type</code></td><td>::mlir::triton::ScaleDotElemTypeAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2, 3, 4, 5, 6</td></tr>
<tr><td><code>b_elem_type</code></td><td>::mlir::triton::ScaleDotElemTypeAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2, 3, 4, 5, 6</td></tr>
<tr><td><code>fastMath</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
<tr><td><code>lhs_k_pack</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
<tr><td><code>rhs_k_pack</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id37">
<h3>Operands:<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">a</span></code></p></td>
<td><p>ranked tensor of floating-point or 8-bit signless integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p>ranked tensor of floating-point or 8-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">c</span></code></p></td>
<td><p>ranked tensor of floating-point values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">a_scale</span></code></p></td>
<td><p>ranked tensor of floating-point or 8-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">b_scale</span></code></p></td>
<td><p>ranked tensor of floating-point or 8-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id38">
<h3>Results:<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">d</span></code></p></td>
<td><p>ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-elementwise-inline-asm-triton-elementwiseinlineasmop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.elementwise_inline_asm</span></code> (triton::ElementwiseInlineAsmOp)<a class="headerlink" href="#tt-elementwise-inline-asm-triton-elementwiseinlineasmop" title="Link to this heading">¶</a></h2>
<p><em>Inline assembly applying an elementwise operation to a group of packed elements.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.elementwise_inline_asm` $asm_string attr-dict ($args^ `:` type($args))? `-&gt;` type($result)
</pre></div>
</div>
<p>Runs an inline asm block to generate one or more tensors.</p>
<p>The asm block is given <code class="docutils literal notranslate"><span class="pre">packed_element</span></code> elements at a time.  Exactly which
elems it receives is unspecified.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id39">
<h3>Attributes:<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>asm_string</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>constraints</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>pure</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
<tr><td><code>packed_element</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id40">
<h3>Operands:<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p>variadic of floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id41">
<h3>Results:<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-expand-dims-triton-expanddimsop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.expand_dims</span></code> (triton::ExpandDimsOp)<a class="headerlink" href="#tt-expand-dims-triton-expanddimsop" title="Link to this heading">¶</a></h2>
<p><em>Expand_dims</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.expand_dims` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id42">
<h3>Attributes:<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id43">
<h3>Operands:<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id44">
<h3>Results:<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-extern-elementwise-triton-externelementwiseop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.extern_elementwise</span></code> (triton::ExternElementwiseOp)<a class="headerlink" href="#tt-extern-elementwise-triton-externelementwiseop" title="Link to this heading">¶</a></h2>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.extern_elementwise` operands attr-dict `:` functional-type(operands, $result)
</pre></div>
</div>
<p>call an external function $symbol implemented in $libpath/$libname with $args
return $libpath/$libname:$symbol($args…)</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameVariadicOperandSize</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id45">
<h3>Attributes:<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>libname</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>libpath</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>symbol</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>pure</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id46">
<h3>Operands:<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">srcs</span></code></p></td>
<td><p>variadic of floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id47">
<h3>Results:<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-fp-to-fp-triton-fptofpop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.fp_to_fp</span></code> (triton::FpToFpOp)<a class="headerlink" href="#tt-fp-to-fp-triton-fptofpop" title="Link to this heading">¶</a></h2>
<p><em>Floating point casting for custom types</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.fp_to_fp` $src attr-dict  (`,` `rounding` `=` $rounding^)? `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Floating point casting for custom types (F8), and non-default rounding modes.</p>
<p>F8 &lt;-&gt; FP16, BF16, FP32, FP64</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id48">
<h3>Attributes:<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>rounding</code></td><td>::mlir::triton::RoundingModeAttr</td><td>allowed 32-bit signless integer cases: 0, 1</td></tr>
</table>
</section>
<section id="id49">
<h3>Operands:<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id50">
<h3>Results:<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-gather-triton-gatherop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.gather</span></code> (triton::GatherOp)<a class="headerlink" href="#tt-gather-triton-gatherop" title="Link to this heading">¶</a></h2>
<p><em>Local gather operation</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.gather` $src `[` $indices `]` attr-dict `:`
              functional-type(operands, results)
</pre></div>
</div>
<p>Gather elements from the input tensor using the indices tensor along a
single specified axis. The output tensor has the same shape as the indices
tensor. The input and indices tensors must have the same number of
dimension, and each dimension of the indices tensor that is not the gather
dimension cannot be greater than the corresponding dimension in the input
tensor.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">efficient_layout</span></code> attribute is set when the compiler has determined an
optimized layout for the operation, indicating that it should not be
changed.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id51">
<h3>Attributes:<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>efficient_layout</code></td><td>::mlir::UnitAttr</td><td>unit attribute</td></tr>
</table>
</section>
<section id="id52">
<h3>Operands:<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">indices</span></code></p></td>
<td><p>ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id53">
<h3>Results:<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-get-num-programs-triton-getnumprogramsop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.get_num_programs</span></code> (triton::GetNumProgramsOp)<a class="headerlink" href="#tt-get-num-programs-triton-getnumprogramsop" title="Link to this heading">¶</a></h2>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.get_num_programs` $axis attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id54">
<h3>Attributes:<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::triton::ProgramIDDimAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2</td></tr>
</table>
</section>
<section id="id55">
<h3>Results:<a class="headerlink" href="#id55" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-get-program-id-triton-getprogramidop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.get_program_id</span></code> (triton::GetProgramIdOp)<a class="headerlink" href="#tt-get-program-id-triton-getprogramidop" title="Link to this heading">¶</a></h2>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.get_program_id` $axis attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id56">
<h3>Attributes:<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::triton::ProgramIDDimAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2</td></tr>
</table>
</section>
<section id="id57">
<h3>Results:<a class="headerlink" href="#id57" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-histogram-triton-histogramop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.histogram</span></code> (triton::HistogramOp)<a class="headerlink" href="#tt-histogram-triton-histogramop" title="Link to this heading">¶</a></h2>
<p><em>Return a histogram of the inputs.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.histogram` $src (`,` $mask^)? attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Return the histogram of the input tensor. The number of bins is equal to
the dimension of the output tensor. Each bins has a width of 1 and bins
start at 0.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id58">
<h3>Operands:<a class="headerlink" href="#id58" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>1-bit signless integer or ranked tensor of 1-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id59">
<h3>Results:<a class="headerlink" href="#id59" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-int-to-ptr-triton-inttoptrop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.int_to_ptr</span></code> (triton::IntToPtrOp)<a class="headerlink" href="#tt-int-to-ptr-triton-inttoptrop" title="Link to this heading">¶</a></h2>
<p><em>Cast int64 to pointer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.int_to_ptr` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id60">
<h3>Operands:<a class="headerlink" href="#id60" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>64-bit signless integer or tensor of 64-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id61">
<h3>Results:<a class="headerlink" href="#id61" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-join-triton-joinop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.join</span></code> (triton::JoinOp)<a class="headerlink" href="#tt-join-triton-joinop" title="Link to this heading">¶</a></h2>
<p><em>Join two tensors along a new, minor dimension</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.join` $lhs `,` $rhs attr-dict `:` type($lhs) `-&gt;` type($result)
</pre></div>
</div>
<p>For example, if the two input tensors are 4x8xf32, returns a tensor of
shape 4x8x2xf32.</p>
<p>Because Triton tensors always have a power-of-two number of elements,
the two input tensors must have the same shape.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameTypeOperands</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id62">
<h3>Operands:<a class="headerlink" href="#id62" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">lhs</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">rhs</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id63">
<h3>Results:<a class="headerlink" href="#id63" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-load-triton-loadop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.load</span></code> (triton::LoadOp)<a class="headerlink" href="#tt-load-triton-loadop" title="Link to this heading">¶</a></h2>
<p><em>Load from a tensor of pointers or from a tensor pointer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.load` $ptr (`,` $mask^)? (`,` $other^)?
              oilist(
              `cacheModifier` `=` $cache |
              `evictionPolicy` `=` $evict
              )
              attr-dict `:` type($ptr)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code>, <code class="docutils literal notranslate"><span class="pre">SameLoadStoreOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameLoadStoreOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id64">
<h3>Attributes:<a class="headerlink" href="#id64" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>boundaryCheck</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
<tr><td><code>padding</code></td><td>::mlir::triton::PaddingOptionAttr</td><td>allowed 32-bit signless integer cases: 1, 2</td></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7</td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
<tr><td><code>isVolatile</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id65">
<h3>Operands:<a class="headerlink" href="#id65" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>1-bit signless integer or ranked tensor of 1-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">other</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id66">
<h3>Results:<a class="headerlink" href="#id66" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-make-range-triton-makerangeop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.make_range</span></code> (triton::MakeRangeOp)<a class="headerlink" href="#tt-make-range-triton-makerangeop" title="Link to this heading">¶</a></h2>
<p><em>Make range</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.make_range` attr-dict `:` type($result)
</pre></div>
</div>
<p>Returns an 1D int32 tensor.</p>
<p>Values span from $start to $end (exclusive), with step = 1</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id67">
<h3>Attributes:<a class="headerlink" href="#id67" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>start</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>end</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id68">
<h3>Results:<a class="headerlink" href="#id68" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-make-tensor-descriptor-triton-maketensordescop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_descriptor</span></code> (triton::MakeTensorDescOp)<a class="headerlink" href="#tt-make-tensor-descriptor-triton-maketensordescop" title="Link to this heading">¶</a></h2>
<p><em>Make a tensor descriptor type with meta information of the parent tensor and block size</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.make_tensor_descriptor` $base `,` `[` $shape `]` `,` `[` $strides `]` attr-dict `:` type($base) `,` type($result)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_descriptor</span></code> takes both meta information of the parent tensor and the block size,
and returns a descriptor object which can be used to load/store from the tensor in global memory.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameVariadicOperandSize</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id69">
<h3>Attributes:<a class="headerlink" href="#id69" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>padding</code></td><td>::mlir::triton::PaddingOptionAttr</td><td>allowed 32-bit signless integer cases: 1, 2</td></tr>
</table>
</section>
<section id="id70">
<h3>Operands:<a class="headerlink" href="#id70" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">base</span></code></p></td>
<td><p>ptr</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">strides</span></code></p></td>
<td><p>variadic of 64-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id71">
<h3>Results:<a class="headerlink" href="#id71" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-make-tensor-ptr-triton-maketensorptrop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_ptr</span></code> (triton::MakeTensorPtrOp)<a class="headerlink" href="#tt-make-tensor-ptr-triton-maketensorptrop" title="Link to this heading">¶</a></h2>
<p><em>Make a tensor pointer type with meta information of the parent tensor and the block specified</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.make_tensor_ptr` $base `,` `[` $shape `]` `,` `[` $strides `]` `,` `[` $offsets `]` attr-dict `:` type($result)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tt.make_tensor_ptr</span></code> takes both meta information of the parent tensor and the block tensor, then it returns a
pointer to the block tensor, e.g. returns a type of <code class="docutils literal notranslate"><span class="pre">tt.ptr&lt;tensor&lt;8x8xf16&gt;&gt;</span></code>.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameVariadicOperandSize</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id72">
<h3>Attributes:<a class="headerlink" href="#id72" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>order</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id73">
<h3>Operands:<a class="headerlink" href="#id73" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">base</span></code></p></td>
<td><p>ptr</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>variadic of 64-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">strides</span></code></p></td>
<td><p>variadic of 64-bit signless integer</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">offsets</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id74">
<h3>Results:<a class="headerlink" href="#id74" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-map-elementwise-triton-mapelementwiseop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.map_elementwise</span></code> (triton::MapElementwiseOp)<a class="headerlink" href="#tt-map-elementwise-triton-mapelementwiseop" title="Link to this heading">¶</a></h2>
<p><em>Map a scalar subregion over a tensor</em></p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">RecursiveMemoryEffects</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id75">
<h3>Attributes:<a class="headerlink" href="#id75" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>pack</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id76">
<h3>Operands:<a class="headerlink" href="#id76" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">srcs</span></code></p></td>
<td><p>variadic of ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id77">
<h3>Results:<a class="headerlink" href="#id77" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-map-elementwise-return-triton-mapelementwisereturnop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.map_elementwise.return</span></code> (triton::MapElementwiseReturnOp)<a class="headerlink" href="#tt-map-elementwise-return-triton-mapelementwisereturnop" title="Link to this heading">¶</a></h2>
<p><em>Terminator for map elementwise operator</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.map_elementwise.return` attr-dict ($result^ `:` type($result))?
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;MapElementwiseOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id78">
<h3>Operands:<a class="headerlink" href="#id78" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-mulhiui-triton-mulhiuiop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.mulhiui</span></code> (triton::MulhiUIOp)<a class="headerlink" href="#tt-mulhiui-triton-mulhiuiop" title="Link to this heading">¶</a></h2>
<p><em>Most significant N bits of the 2N-bit product of two integers</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.mulhiui` $x `,` $y attr-dict `:` type($x)
</pre></div>
</div>
<p>Most significant N bits of the 2N-bit product of two integers.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id79">
<h3>Operands:<a class="headerlink" href="#id79" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>integer or ranked tensor of integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></td>
<td><p>integer or ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id80">
<h3>Results:<a class="headerlink" href="#id80" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>integer or ranked tensor of integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-precise-divf-triton-precisedivfop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.precise_divf</span></code> (triton::PreciseDivFOp)<a class="headerlink" href="#tt-precise-divf-triton-precisedivfop" title="Link to this heading">¶</a></h2>
<p><em>Precise div for floating point types</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.precise_divf` $x `,` $y attr-dict `:` type($x)
</pre></div>
</div>
<p>Precise div for floating point types.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id81">
<h3>Operands:<a class="headerlink" href="#id81" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id82">
<h3>Results:<a class="headerlink" href="#id82" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-precise-sqrt-triton-precisesqrtop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.precise_sqrt</span></code> (triton::PreciseSqrtOp)<a class="headerlink" href="#tt-precise-sqrt-triton-precisesqrtop" title="Link to this heading">¶</a></h2>
<p><em>Precise sqrt for floating point types</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.precise_sqrt` $x attr-dict `:` type($x)
</pre></div>
</div>
<p>Precise sqrt for floating point types.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id83">
<h3>Operands:<a class="headerlink" href="#id83" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id84">
<h3>Results:<a class="headerlink" href="#id84" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-print-triton-printop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.print</span></code> (triton::PrintOp)<a class="headerlink" href="#tt-print-triton-printop" title="Link to this heading">¶</a></h2>
<p><em>Device-side print, as in CUDA for debugging</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.print` $prefix attr-dict (`:` $args^ `:` type($args))?
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tt.print</span></code> takes a literal string prefix and an arbitrary number of scalar or tensor arguments that should be printed.
format are generated automatically from the arguments.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SameVariadicOperandSize</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{MemoryEffects::Write</span> <span class="pre">on</span> <span class="pre">::mlir::triton::GlobalMemory}</span></code></p>
<section id="id85">
<h3>Attributes:<a class="headerlink" href="#id85" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>prefix</code></td><td>::mlir::StringAttr</td><td>string attribute</td></tr>
<tr><td><code>hex</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
<tr><td><code>isSigned</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id86">
<h3>Operands:<a class="headerlink" href="#id86" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p></td>
<td><p>variadic of floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-ptr-to-int-triton-ptrtointop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.ptr_to_int</span></code> (triton::PtrToIntOp)<a class="headerlink" href="#tt-ptr-to-int-triton-ptrtointop" title="Link to this heading">¶</a></h2>
<p><em>Cast pointer to int64</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.ptr_to_int` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Elementwise</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id87">
<h3>Operands:<a class="headerlink" href="#id87" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id88">
<h3>Results:<a class="headerlink" href="#id88" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>64-bit signless integer or tensor of 64-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-reduce-triton-reduceop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.reduce</span></code> (triton::ReduceOp)<a class="headerlink" href="#tt-reduce-triton-reduceop" title="Link to this heading">¶</a></h2>
<p><em>Reduction using generic combination algorithm</em></p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsShape</span></code>, <code class="docutils literal notranslate"><span class="pre">SingleBlock</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id89">
<h3>Attributes:<a class="headerlink" href="#id89" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id90">
<h3>Operands:<a class="headerlink" href="#id90" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">srcs</span></code></p></td>
<td><p>variadic of ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id91">
<h3>Results:<a class="headerlink" href="#id91" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-reduce-return-triton-reducereturnop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.reduce.return</span></code> (triton::ReduceReturnOp)<a class="headerlink" href="#tt-reduce-return-triton-reducereturnop" title="Link to this heading">¶</a></h2>
<p><em>Terminator for reduce operator</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.reduce.return` $result attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;ReduceOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id92">
<h3>Operands:<a class="headerlink" href="#id92" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-reshape-triton-reshapeop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.reshape</span></code> (triton::ReshapeOp)<a class="headerlink" href="#tt-reshape-triton-reshapeop" title="Link to this heading">¶</a></h2>
<p><em>Reinterpret a tensor to a different shape. It may change elements order if the attribute is set.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.reshape` $src (`allow_reorder` $allow_reorder^)? (`efficient_layout` $efficient_layout^)? attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>reinterpret a tensor to a different shape.</p>
<p>If allow_reorder is set the compiler is free to change the order of
elements to generate more efficient code.</p>
<p>If efficient_layout is set, this is a hint that the destination layout should be kept for performance reason.
The compiler is still free to change it for better performance.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id93">
<h3>Attributes:<a class="headerlink" href="#id93" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>allow_reorder</code></td><td>::mlir::UnitAttr</td><td>unit attribute</td></tr>
<tr><td><code>efficient_layout</code></td><td>::mlir::UnitAttr</td><td>unit attribute</td></tr>
</table>
</section>
<section id="id94">
<h3>Operands:<a class="headerlink" href="#id94" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id95">
<h3>Results:<a class="headerlink" href="#id95" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-scan-triton-scanop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.scan</span></code> (triton::ScanOp)<a class="headerlink" href="#tt-scan-triton-scanop" title="Link to this heading">¶</a></h2>
<p><em>Associative scan using generic combination algorithm</em></p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">SingleBlock</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id96">
<h3>Attributes:<a class="headerlink" href="#id96" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>reverse</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id97">
<h3>Operands:<a class="headerlink" href="#id97" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">srcs</span></code></p></td>
<td><p>variadic of ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id98">
<h3>Results:<a class="headerlink" href="#id98" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-scan-return-triton-scanreturnop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.scan.return</span></code> (triton::ScanReturnOp)<a class="headerlink" href="#tt-scan-return-triton-scanreturnop" title="Link to this heading">¶</a></h2>
<p><em>Terminator for scan operator</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.scan.return` $result attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;ScanOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id99">
<h3>Operands:<a class="headerlink" href="#id99" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-splat-triton-splatop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.splat</span></code> (triton::SplatOp)<a class="headerlink" href="#tt-splat-triton-splatop" title="Link to this heading">¶</a></h2>
<p><em>Splat</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.splat` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id100">
<h3>Operands:<a class="headerlink" href="#id100" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id101">
<h3>Results:<a class="headerlink" href="#id101" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-split-triton-splitop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.split</span></code> (triton::SplitOp)<a class="headerlink" href="#tt-split-triton-splitop" title="Link to this heading">¶</a></h2>
<p><em>Splits a tensor into two, along its last dimension</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.split` $src attr-dict `:` type($src) `-&gt;` type($outLHS)
</pre></div>
</div>
<p>The input must be a tensor whose last dimension has size 2.  Returns two
tensors, src[…, 0] and src[…, 1].</p>
<p>For example, if the input shape is 4x8x2xf32, returns two tensors of
shape 4x8xf32.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpAdaptor</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id102">
<h3>Operands:<a class="headerlink" href="#id102" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id103">
<h3>Results:<a class="headerlink" href="#id103" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">outLHS</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">outRHS</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-store-triton-storeop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.store</span></code> (triton::StoreOp)<a class="headerlink" href="#tt-store-triton-storeop" title="Link to this heading">¶</a></h2>
<p><em>Store by a tensor of pointers or by a tensor pointer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.store` $ptr `,` $value (`,` $mask^)?
              oilist(`cacheModifier` `=` $cache | `evictionPolicy` `=` $evict)
              attr-dict `:` type($ptr)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SameLoadStoreOperandsEncoding</span></code>, <code class="docutils literal notranslate"><span class="pre">SameLoadStoreOperandsShape</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id104">
<h3>Attributes:<a class="headerlink" href="#id104" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>boundaryCheck</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7</td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
</table>
</section>
<section id="id105">
<h3>Operands:<a class="headerlink" href="#id105" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ptr</span></code></p></td>
<td><p>ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">value</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>1-bit signless integer or ranked tensor of 1-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tt-trans-triton-transop">
<h2><code class="docutils literal notranslate"><span class="pre">tt.trans</span></code> (triton::TransOp)<a class="headerlink" href="#tt-trans-triton-transop" title="Link to this heading">¶</a></h2>
<p><em>Rearrange the dimensions of a tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.trans` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>For example, given a tensor x with shape [1,2,4], transpose(x) with
order=[2,0,1] rearranges the tensor to have shape [4,1,2].</p>
<p>Although this op is called “trans”, it implements both tl.trans() and
tl.permute().  (“permute” might be a better name, but it’s called “trans”
because originally it only supported 2D tensors.)</p>
</section>
<section id="implementation-note-on-encodings">
<h2>Implementation note on encodings:<a class="headerlink" href="#implementation-note-on-encodings" title="Link to this heading">¶</a></h2>
<p>In the TritonGPU dialect (and probably others), an encoding is chosen for
this op’s output so it’s a nop from the perspective of code generation.</p>
<p>For example, suppose tensor x has an encoding such that GPU thread [i,j,k]
has a register containing element [i,j,k] of the tensor.  Now we transpose
x with order [2,1,0], i.e. we reverse the order of its dimensions.  In
TritonGPU, we will choose a layout for the output of the transpose so that
GPU thread [i,j,k] has element [k,j,i] of transpose(x).  But this is the
same element it had before!  All we’ve done is “rename” the element that
thread [i,j,k] has.</p>
<p>The “real” transpose – i.e. moving data between GPU threads – occurs in
convertLayout ops that appear before and/or after the operation.</p>
<p>We do this so that you can chain multiple data-movement ops (e.g.
transpose+reshape+concat) without going to shared memory after each one.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpAdaptor</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">TransposeOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id106">
<h3>Attributes:<a class="headerlink" href="#id106" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>order</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id107">
<h3>Operands:<a class="headerlink" href="#id107" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id108">
<h3>Results:<a class="headerlink" href="#id108" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tt-unsplat-triton-unsplatop">
<h3><code class="docutils literal notranslate"><span class="pre">tt.unsplat</span></code> (triton::UnsplatOp)<a class="headerlink" href="#tt-unsplat-triton-unsplatop" title="Link to this heading">¶</a></h3>
<p><em>Convert a tensor with a single element to a scalar</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `tt.unsplat` $src attr-dict `:` type($src)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorSizeTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id109">
<h4>Operands:<a class="headerlink" href="#id109" title="Link to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id110">
<h4>Results:<a class="headerlink" href="#id110" title="Link to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GluonOps.html" class="btn btn-neutral float-left" title="GluonOps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="TritonNvidiaGPUOps.html" class="btn btn-neutral float-right" title="TritonNvidiaGPUOps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Philippe Tillet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>