

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TritonGPUOps &mdash; Triton  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ProtonOps" href="ProtonOps.html" />
    <link rel="prev" title="TritonAMDGPUOps" href="TritonAMDGPUOps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Triton
              <img src="https://cdn.openai.com/triton/assets/triton-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.html">triton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.language.html">triton.language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.testing.html">triton.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton-semantics.html">Triton Semantics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Triton MLIR Dialects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dialects.html">Triton MLIR Dialects and Ops</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GluonDialect.html">‘gluon’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUDialect.html">‘ttng’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUDialect.html">‘ttg’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonDialect.html">‘proton’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUDialect.html">‘nvgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVWSDialect.html">‘nvws’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonDialect.html">‘tt’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentDialect.html">‘tti’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUDialect.html">‘amdgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentOps.html">TritonInstrumentOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUOps.html">TritonAMDGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ttg-async-commit-group-triton-gpu-asynccommitgroupop"><code class="docutils literal notranslate"><span class="pre">ttg.async_commit_group</span></code> (triton::gpu::AsyncCommitGroupOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operands">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop"><code class="docutils literal notranslate"><span class="pre">ttg.async_copy_global_to_local</span></code> (triton::gpu::AsyncCopyGlobalToLocalOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-async-wait-triton-gpu-asyncwaitop"><code class="docutils literal notranslate"><span class="pre">ttg.async_wait</span></code> (triton::gpu::AsyncWaitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-convert-layout-triton-gpu-convertlayoutop"><code class="docutils literal notranslate"><span class="pre">ttg.convert_layout</span></code> (triton::gpu::ConvertLayoutOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-fp4-to-fp-triton-gpu-fp4tofpop"><code class="docutils literal notranslate"><span class="pre">ttg.fp4_to_fp</span></code> (triton::gpu::Fp4ToFpOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-global-scratch-alloc-triton-gpu-globalscratchallocop"><code class="docutils literal notranslate"><span class="pre">ttg.global_scratch_alloc</span></code> (triton::gpu::GlobalScratchAllocOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-local-alloc-triton-gpu-localallocop"><code class="docutils literal notranslate"><span class="pre">ttg.local_alloc</span></code> (triton::gpu::LocalAllocOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id13">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-local-dealloc-triton-gpu-localdeallocop"><code class="docutils literal notranslate"><span class="pre">ttg.local_dealloc</span></code> (triton::gpu::LocalDeallocOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-local-load-triton-gpu-localloadop"><code class="docutils literal notranslate"><span class="pre">ttg.local_load</span></code> (triton::gpu::LocalLoadOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-local-store-triton-gpu-localstoreop"><code class="docutils literal notranslate"><span class="pre">ttg.local_store</span></code> (triton::gpu::LocalStoreOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id19">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-mask-triton-gpu-maskop"><code class="docutils literal notranslate"><span class="pre">ttg.mask</span></code> (triton::gpu::MaskOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-mask-return-triton-gpu-maskreturnop"><code class="docutils literal notranslate"><span class="pre">ttg.mask.return</span></code> (triton::gpu::MaskReturnOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-memdesc-reinterpret-triton-gpu-memdescreinterpretop"><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_reinterpret</span></code> (triton::gpu::MemDescReinterpretOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-memdesc-reshape-triton-gpu-memdescreshapeop"><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_reshape</span></code> (triton::gpu::MemDescReshapeOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-memdesc-subview-triton-gpu-memdescsubviewop"><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_subview</span></code> (triton::gpu::MemDescSubviewOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id27">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-memdesc-trans-triton-gpu-memdesctransop"><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_trans</span></code> (triton::gpu::MemDescTransOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id29">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-predicate-stage-triton-gpu-predicatestageop"><code class="docutils literal notranslate"><span class="pre">ttg.predicate_stage</span></code> (triton::gpu::PredicateStageOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id32">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-warp-return-triton-gpu-warpreturnop"><code class="docutils literal notranslate"><span class="pre">ttg.warp_return</span></code> (triton::gpu::WarpReturnOp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-warp-specialize-triton-gpu-warpspecializeop"><code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> (triton::gpu::WarpSpecializeOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id35">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-warp-specialize-partitions-triton-gpu-warpspecializepartitionsop"><code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize.partitions</span></code> (triton::gpu::WarpSpecializePartitionsOp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ttg-warp-yield-triton-gpu-warpyieldop"><code class="docutils literal notranslate"><span class="pre">ttg.warp_yield</span></code> (triton::gpu::WarpYieldOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id38">Operands:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ProtonOps.html">ProtonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonOps.html">TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUOps.html">TritonNvidiaGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUOps.html">NVGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVWSOps.html">NVWSOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-1/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-2/related-work.html">Related Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-3/debugging.html">Debugging Triton</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Triton</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dialects.html">Triton MLIR Dialects and Ops</a></li>
      <li class="breadcrumb-item active">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dialects/TritonGPUOps.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tritongpuops">
<h1>TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --><a class="headerlink" href="#tritongpuops" title="Link to this heading">¶</a></h1>
<section id="ttg-async-commit-group-triton-gpu-asynccommitgroupop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.async_commit_group</span></code> (triton::gpu::AsyncCommitGroupOp)<a class="headerlink" href="#ttg-async-commit-group-triton-gpu-asynccommitgroupop" title="Link to this heading">¶</a></h2>
<p><em>Async commit group</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.async_commit_group` $inputTokens attr-dict
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code></p>
<section id="operands">
<h3>Operands:<a class="headerlink" href="#operands" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">inputTokens</span></code></p></td>
<td><p>variadic of async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="results">
<h3>Results:<a class="headerlink" href="#results" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">asyncToken</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.async_copy_global_to_local</span></code> (triton::gpu::AsyncCopyGlobalToLocalOp)<a class="headerlink" href="#ttg-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop" title="Link to this heading">¶</a></h2>
<p><em>Copy data from global memory to local memory asynchronously</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.async_copy_global_to_local` $src `,` $result (`mask` $mask^)? (`other` $other^)?
              oilist(`cacheModifier` `=` $cache | `evictionPolicy` `=` $evict)
              attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>This operation copies data from global memory to local memory asynchronously.
This is analogue to tt.load except the data are copied to local memory pointed
to by the memory descriptor instead of a distributed tensor. The rest of the
operands are the same as tt.load.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code></p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7</td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
<tr><td><code>isVolatile</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id1">
<h3>Operands:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>tensor of 1-bit signless integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">other</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h3>Results:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-async-wait-triton-gpu-asyncwaitop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.async_wait</span></code> (triton::gpu::AsyncWaitOp)<a class="headerlink" href="#ttg-async-wait-triton-gpu-asyncwaitop" title="Link to this heading">¶</a></h2>
<p><em>Async wait</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.async_wait` $asyncToken attr-dict
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code></p>
<section id="id3">
<h3>Attributes:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>num</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id4">
<h3>Operands:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">asyncToken</span></code></p></td>
<td><p>variadic of async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id5">
<h3>Results:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">retToken</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-convert-layout-triton-gpu-convertlayoutop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.convert_layout</span></code> (triton::gpu::ConvertLayoutOp)<a class="headerlink" href="#ttg-convert-layout-triton-gpu-convertlayoutop" title="Link to this heading">¶</a></h2>
<p><em>Convert layout</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.convert_layout` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id6">
<h3>Operands:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h3>Results:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-fp4-to-fp-triton-gpu-fp4tofpop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.fp4_to_fp</span></code> (triton::gpu::Fp4ToFpOp)<a class="headerlink" href="#ttg-fp4-to-fp-triton-gpu-fp4tofpop" title="Link to this heading">¶</a></h2>
<p><em>Upcast fp4 (e2m1) to fp</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.fp4_to_fp` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Upcast fp4 (e2m1) represented packed as i8s to fp.</p>
<p>The lower 4 bits of the i8s represent the first fp4 element, and the upper 4 bits
the second fp4 element.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute specifies the axis along which the fp4 elements are packed.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id8">
<h3>Attributes:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>axis</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id9">
<h3>Operands:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of 8-bit signless integer values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id10">
<h3>Results:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-global-scratch-alloc-triton-gpu-globalscratchallocop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.global_scratch_alloc</span></code> (triton::gpu::GlobalScratchAllocOp)<a class="headerlink" href="#ttg-global-scratch-alloc-triton-gpu-globalscratchallocop" title="Link to this heading">¶</a></h2>
<p><em>Allocate a global memory buffer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.global_scratch_alloc` attr-dict `:` qualified(type($result))
</pre></div>
</div>
<p>This operation allocates a buffer in global memory that is private to the current program.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id11">
<h3>Attributes:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>nbytes</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>alignment</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id12">
<h3>Results:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ptr</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-local-alloc-triton-gpu-localallocop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.local_alloc</span></code> (triton::gpu::LocalAllocOp)<a class="headerlink" href="#ttg-local-alloc-triton-gpu-localallocop" title="Link to this heading">¶</a></h2>
<p><em>Allocate tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.local_alloc` ($src^)? attr-dict `:` functional-type(operands, results)
</pre></div>
</div>
<p>This operation allocates buffer in shared memory and return a descriptor
containing the address and a view of the buffer.</p>
<p>Explicitly deallocating a buffer is optional; see local_dealloc.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">src</span></code> operand is an optional initializer for the allocated buffer. It
must have the element type as the buffer. If <code class="docutils literal notranslate"><span class="pre">src</span></code> is not specified, the
returned buffer must be mutable.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id13">
<h3>Attributes:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>alignment</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id14">
<h3>Operands:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id15">
<h3>Results:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-local-dealloc-triton-gpu-localdeallocop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.local_dealloc</span></code> (triton::gpu::LocalDeallocOp)<a class="headerlink" href="#ttg-local-dealloc-triton-gpu-localdeallocop" title="Link to this heading">¶</a></h2>
<p><em>Dealloc buffer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.local_dealloc` $src attr-dict `:` qualified(type($src))
</pre></div>
</div>
<p>This operation deallocates a buffer explicitly. Using the buffer after this
operation is undefined.</p>
<p>This operation is optional.  If you don’t explicitly dealloc a buffer, the
compiler assumes it’s deallocated at the first point that post-dominates all
uses of the alloc.</p>
<p>Because we assume a memdesc is dead at the first point that post-dominates
its uses, ops that wait for an async operation on a memdesc to complete
(such as ttng.warp_group_dot_wait) should also take the memdesc as an
operand.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id16">
<h3>Operands:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-local-load-triton-gpu-localloadop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.local_load</span></code> (triton::gpu::LocalLoadOp)<a class="headerlink" href="#ttg-local-load-triton-gpu-localloadop" title="Link to this heading">¶</a></h2>
<p><em>Load a buffer from local memory into a distributed tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.local_load` $src (`token` $token^)? attr-dict `:` qualified(type($src)) `-&gt;` type($result)
</pre></div>
</div>
<p>Load a tensor from the local memory descriptor into a distributed tensor.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id17">
<h3>Operands:<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id18">
<h3>Results:<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-local-store-triton-gpu-localstoreop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.local_store</span></code> (triton::gpu::LocalStoreOp)<a class="headerlink" href="#ttg-local-store-triton-gpu-localstoreop" title="Link to this heading">¶</a></h2>
<p><em>Store a distributed tensor into a buffer in local memory</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.local_store` $src `,` $dst attr-dict `:` type($src) `-&gt;` qualified(type($dst))
</pre></div>
</div>
<p>Store a distributed tensor into a buffer in local memory.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id19">
<h3>Operands:<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">dst</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-mask-triton-gpu-maskop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.mask</span></code> (triton::gpu::MaskOp)<a class="headerlink" href="#ttg-mask-triton-gpu-maskop" title="Link to this heading">¶</a></h2>
<p><em>Mask op for pipelining</em></p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">SingleBlock</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<section id="id20">
<h3>Operands:<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">pred</span></code></p></td>
<td><p>1-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id21">
<h3>Results:<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-mask-return-triton-gpu-maskreturnop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.mask.return</span></code> (triton::gpu::MaskReturnOp)<a class="headerlink" href="#ttg-mask-return-triton-gpu-maskreturnop" title="Link to this heading">¶</a></h2>
<p><em>Terminator for mask operator</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.mask.return` $result attr-dict `:` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;MaskOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id22">
<h3>Operands:<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-memdesc-reinterpret-triton-gpu-memdescreinterpretop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_reinterpret</span></code> (triton::gpu::MemDescReinterpretOp)<a class="headerlink" href="#ttg-memdesc-reinterpret-triton-gpu-memdescreinterpretop" title="Link to this heading">¶</a></h2>
<p><em>Reinterpret a memory descriptor as a different type and shape</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.memdesc_reinterpret` $src attr-dict `:` qualified(type($src)) `-&gt;` qualified(type($result))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ttg.memdesc_reinterpret</span></code> operation reinterprets a memory descriptor
as one with a different shape and element type. Because memory descriptors
lack strides, this operation is only valid if the original memory descriptor
is contiguous.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">MemDescViewTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id23">
<h3>Operands:<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id24">
<h3>Results:<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-memdesc-reshape-triton-gpu-memdescreshapeop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_reshape</span></code> (triton::gpu::MemDescReshapeOp)<a class="headerlink" href="#ttg-memdesc-reshape-triton-gpu-memdescreshapeop" title="Link to this heading">¶</a></h2>
<p><em>Creates a descriptor for the new shape</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.memdesc_reshape` $src attr-dict `:` qualified(type($src)) `-&gt;` qualified(type($result))
</pre></div>
</div>
<p>This operation returns a new descriptor representing a reshaped view of the underlying buffer.
This doesn’t affect the memory.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">MemDescViewTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id25">
<h3>Operands:<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id26">
<h3>Results:<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-memdesc-subview-triton-gpu-memdescsubviewop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_subview</span></code> (triton::gpu::MemDescSubviewOp)<a class="headerlink" href="#ttg-memdesc-subview-triton-gpu-memdescsubviewop" title="Link to this heading">¶</a></h2>
<p><em>Take a subview of the descriptor.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.memdesc_subview` $src `[` $offsets `]` attr-dict `:` qualified(type($src)) `-&gt;` qualified(type($result))
</pre></div>
</div>
<p>This operation returns a new descriptor representing a subview of the buffer.
It doesn’t affect the underlying memory.</p>
<p>For example, suppose that</p>
<ul class="simple">
<li><p>the input shape is 2x4x16xf16,</p></li>
<li><p>the output shape is 4x16xf16, and</p></li>
<li><p>offsets = [1, 0, 0].</p></li>
</ul>
<p>Then in Python syntax, the subview covers input[1].</p>
<p>Just one dimension may be split (at most one non-zero offset).</p>
<p>When the input shape and the output shape have different rank:
Or the output shape is a tensor of 1D tensor of 1 element:</p>
<ul class="simple">
<li><p>The rank of the output must be 1D smaller than the input.</p></li>
<li><p>We assume the input is split along the 0th dimension.</p></li>
<li><p>The offset along the 0th dimension may be a runtime value.
When the input and the output have the same rank:</p></li>
<li><p>The offset must be a compile-time constant</p></li>
<li><p>Larger or equal to the tile of the tensor (or zero)</p></li>
<li><p>That does not split the input along the swizzling pattern (if any)</p></li>
</ul>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">MemDescViewTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id27">
<h3>Operands:<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">offsets</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id28">
<h3>Results:<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-memdesc-trans-triton-gpu-memdesctransop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.memdesc_trans</span></code> (triton::gpu::MemDescTransOp)<a class="headerlink" href="#ttg-memdesc-trans-triton-gpu-memdesctransop" title="Link to this heading">¶</a></h2>
<p><em>Transpose the descriptor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.memdesc_trans` $src attr-dict `:` qualified(type($src)) `-&gt;` qualified(type($result))
</pre></div>
</div>
<p>This operation returns a new descriptor
representing a transposed view of the buffer.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpAdaptor</span></code>, <code class="docutils literal notranslate"><span class="pre">MemDescViewTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">TransposeOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id29">
<h3>Attributes:<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>order</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id30">
<h3>Operands:<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id31">
<h3>Results:<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-predicate-stage-triton-gpu-predicatestageop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.predicate_stage</span></code> (triton::gpu::PredicateStageOp)<a class="headerlink" href="#ttg-predicate-stage-triton-gpu-predicatestageop" title="Link to this heading">¶</a></h2>
<p><em>Pipeliner stage predicate</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.predicate_stage` $iv `,` $ub `,` $step `maxStage` $maxStage `stage` $stage attr-dict `:` type($iv) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id32">
<h3>Attributes:<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>maxStage</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>stage</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id33">
<h3>Operands:<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">iv</span></code></p></td>
<td><p>signless integer or index</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ub</span></code></p></td>
<td><p>signless integer or index</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">step</span></code></p></td>
<td><p>signless integer or index</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id34">
<h3>Results:<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>1-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-warp-return-triton-gpu-warpreturnop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.warp_return</span></code> (triton::gpu::WarpReturnOp)<a class="headerlink" href="#ttg-warp-return-triton-gpu-warpreturnop" title="Link to this heading">¶</a></h2>
<p><em>Implicit terminator from partition regions</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.warp_return` attr-dict
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ttg.warp_return</span></code> operation is the implicit terminator that ends the
partition regions of a <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> op. It has no operands as these
regions cannot return anything.</p>
<p>TODO: Support returning uniform values from partition regions.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;WarpSpecializePartitionsOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
</section>
<section id="ttg-warp-specialize-triton-gpu-warpspecializeop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> (triton::gpu::WarpSpecializeOp)<a class="headerlink" href="#ttg-warp-specialize-triton-gpu-warpspecializeop" title="Link to this heading">¶</a></h2>
<p><em>Asynchronously execute code on multiple warpgroups</em></p>
<p>The <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> op represents executing different code
simultaneously on different warp groups. A warp group is a group of
power-of-2 warps, which can be a different number of warps than in the
enclosing region.</p>
<p>The “default” region of the op represents the code executed by the currently
executing warp group. This region is allowed to implicitly capture. The op
contains a number of “partition” regions that are isolated from above. They
must be isolated because these regions represent different layout domains,
as the number of warps is different.</p>
<p>Semantically, execution of each region starts simultaneously for each warp
group, and all warp groups are joined at the end of the op.</p>
<p>Example:</p>
<div class="highlight-mlir notranslate"><div class="highlight"><pre><span></span>%0 = ttg.warp_specialize(%a, %b)
default {
  %out = some_operation(%a) // implicit capture of `%a`
  ttg.warp_yield %out : i32
}
partition0(%arg0: i32, %arg1: i32) num_warps(8) {
  some_async_dispatch(%arg0, %arg1)
  ttg.warp_return
}
partition1(%arg0: i32, %arg1: i32) num_warps(1) {
  some_async_dispatch(%arg0, %arg1)
  ttg.warp_return
} : (i32, i32) -&gt; i32
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AsyncRegions</span></code>, <code class="docutils literal notranslate"><span class="pre">RecursiveMemoryEffects</span></code>, <code class="docutils literal notranslate"><span class="pre">RecursivelySpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchOpInterface</span></code></p>
<section id="id35">
<h3>Attributes:<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>partitionNumWarps</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
<tr><td><code>warpGroupStartIds</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
<tr><td><code>requestedRegisters</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
<tr><td><code>actualRegisters</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id36">
<h3>Operands:<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">explicitCaptures</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id37">
<h3>Results:<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">defaultPassthrough</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ttg-warp-specialize-partitions-triton-gpu-warpspecializepartitionsop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize.partitions</span></code> (triton::gpu::WarpSpecializePartitionsOp)<a class="headerlink" href="#ttg-warp-specialize-partitions-triton-gpu-warpspecializepartitionsop" title="Link to this heading">¶</a></h2>
<p><em>Container op for <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code></em></p>
<p>Because MLIR requires entire operations be isolated from above, this op
contains the actual isolated from above regions of <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code>.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">HasParent&lt;WarpSpecializeOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">IsolatedFromAbove</span></code>, <code class="docutils literal notranslate"><span class="pre">RecursiveMemoryEffects</span></code>, <code class="docutils literal notranslate"><span class="pre">RecursivelySpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code></p>
</section>
<section id="ttg-warp-yield-triton-gpu-warpyieldop">
<h2><code class="docutils literal notranslate"><span class="pre">ttg.warp_yield</span></code> (triton::gpu::WarpYieldOp)<a class="headerlink" href="#ttg-warp-yield-triton-gpu-warpyieldop" title="Link to this heading">¶</a></h2>
<p><em>Yield from the default region of <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code></em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `ttg.warp_yield` ($values^)? attr-dict (`:` type($values)^)?
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ttg.warp_yield</span></code> operation is the terminator for the “default” region of
a <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> operation. The operands are passed transparently as
the SSA results of the <code class="docutils literal notranslate"><span class="pre">ttg.warp_specialize</span></code> operation.</p>
<p>Example:</p>
<div class="highlight-mlir notranslate"><div class="highlight"><pre><span></span>ttg.warp_yield %a, %b : i32, tensor&lt;32xbf16, #blocked&gt;
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;WarpSpecializeOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id38">
<h3>Operands:<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="TritonAMDGPUOps.html" class="btn btn-neutral float-left" title="TritonAMDGPUOps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ProtonOps.html" class="btn btn-neutral float-right" title="ProtonOps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Philippe Tillet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>