<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TritonGPUOps &mdash; Triton  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TritonOps" href="TritonOps.html" />
    <link rel="prev" title="‘tt’ Dialect" href="TritonDialect.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Triton
              <img src="https://cdn.openai.com/triton/assets/triton-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.html">triton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.language.html">triton.language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.testing.html">triton.testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Triton MLIR Dialects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dialects.html">Triton MLIR Dialects and Ops</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUDialect.html">‘triton_nvidia_gpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUDialect.html">‘triton_gpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUDialect.html">‘nvgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonDialect.html">‘tt’ Dialect</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-async-commit-group-triton-gpu-asynccommitgroupop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_commit_group</span></code> (triton::gpu::AsyncCommitGroupOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operands">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_copy_global_to_local</span></code> (triton::gpu::AsyncCopyGlobalToLocalOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-async-wait-triton-gpu-asyncwaitop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_wait</span></code> (triton::gpu::AsyncWaitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-convert-layout-triton-gpu-convertlayoutop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.convert_layout</span></code> (triton::gpu::ConvertLayoutOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-local-alloc-triton-gpu-localallocop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_alloc</span></code> (triton::gpu::LocalAllocOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-local-dealloc-triton-gpu-localdeallocop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_dealloc</span></code> (triton::gpu::LocalDeallocOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-local-load-triton-gpu-localloadop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_load</span></code> (triton::gpu::LocalLoadOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-local-store-triton-gpu-localstoreop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_store</span></code> (triton::gpu::LocalStoreOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triton-gpu-memdesc-subview-triton-gpu-memdescsubviewop"><code class="docutils literal notranslate"><span class="pre">triton_gpu.memdesc_subview</span></code> (triton::gpu::MemDescSubviewOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">Results:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TritonOps.html">TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUOps.html">TritonNvidiaGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUOps.html">NVGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-1/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-2/related-work.html">Related Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-3/debugging.html">Debugging Triton</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Triton</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dialects.html">Triton MLIR Dialects and Ops</a></li>
      <li class="breadcrumb-item active">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dialects/TritonGPUOps.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tritongpuops">
<h1>TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --><a class="headerlink" href="#tritongpuops" title="Link to this heading">¶</a></h1>
<section id="triton-gpu-async-commit-group-triton-gpu-asynccommitgroupop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_commit_group</span></code> (triton::gpu::AsyncCommitGroupOp)<a class="headerlink" href="#triton-gpu-async-commit-group-triton-gpu-asynccommitgroupop" title="Link to this heading">¶</a></h2>
<p><em>Async commit group</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.async_commit_group` $inputTokens attr-dict
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code></p>
<section id="operands">
<h3>Operands:<a class="headerlink" href="#operands" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">inputTokens</span></code></p></td>
<td><p>variadic of async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="results">
<h3>Results:<a class="headerlink" href="#results" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">asyncToken</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_copy_global_to_local</span></code> (triton::gpu::AsyncCopyGlobalToLocalOp)<a class="headerlink" href="#triton-gpu-async-copy-global-to-local-triton-gpu-asynccopyglobaltolocalop" title="Link to this heading">¶</a></h2>
<p><em>Copy data from global memory to local memory asynchronously</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.async_copy_global_to_local` $src `,` $result (`mask` $mask^)? (`other` $other^)?
              oilist(`cacheModifier` `=` $cache | `evictionPolicy` `=` $evict)
              attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>This operation copies data from global memory to local memory asynchronously.
This is analogue to tt.load except the data are copied to local memory pointed
by by the memory descriptor instread of a distributed tensor. The rest of the
operands are the same as tt.load.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td><details><summary>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6</summary>{{% markdown %}}Enum cases:
* none (`NONE`)
* ca (`CA`)
* cg (`CG`)
* wb (`WB`)
* cs (`CS`)
* wt (`WT`){{% /markdown %}}</details></td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td><details><summary>allowed 32-bit signless integer cases: 1, 2, 3</summary>{{% markdown %}}Enum cases:
* evict_normal (`NORMAL`)
* evict_first (`EVICT_FIRST`)
* evict_last (`EVICT_LAST`){{% /markdown %}}</details></td></tr>
<tr><td><code>isVolatile</code></td><td>::mlir::BoolAttr</td><td>bool attribute</td></tr>
</table>
</section>
<section id="id1">
<h3>Operands:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">mask</span></code></p></td>
<td><p>tensor of 1-bit signless integer values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">other</span></code></p></td>
<td><p>floating-point or ranked tensor of floating-point values or integer or ranked tensor of integer values or ptr or ranked tensor of ptr values or ptr</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h3>Results:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-async-wait-triton-gpu-asyncwaitop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.async_wait</span></code> (triton::gpu::AsyncWaitOp)<a class="headerlink" href="#triton-gpu-async-wait-triton-gpu-asyncwaitop" title="Link to this heading">¶</a></h2>
<p><em>Async wait</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.async_wait` $asyncToken attr-dict
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">InferTypeOpInterface</span></code></p>
<section id="id3">
<h3>Attributes:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>num</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id4">
<h3>Operands:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">asyncToken</span></code></p></td>
<td><p>variadic of async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id5">
<h3>Results:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">retToken</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-convert-layout-triton-gpu-convertlayoutop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.convert_layout</span></code> (triton::gpu::ConvertLayoutOp)<a class="headerlink" href="#triton-gpu-convert-layout-triton-gpu-convertlayoutop" title="Link to this heading">¶</a></h2>
<p><em>Convert layout</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.convert_layout` $src attr-dict `:` type($src) `-&gt;` type($result)
</pre></div>
</div>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultElementType</span></code>, <code class="docutils literal notranslate"><span class="pre">SameOperandsAndResultShape</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id6">
<h3>Operands:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h3>Results:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-local-alloc-triton-gpu-localallocop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_alloc</span></code> (triton::gpu::LocalAllocOp)<a class="headerlink" href="#triton-gpu-local-alloc-triton-gpu-localallocop" title="Link to this heading">¶</a></h2>
<p><em>Allocate tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.local_alloc` $src attr-dict `:` functional-type(operands, results)
</pre></div>
</div>
<p>This operation allocates buffer in shared memory and return a descriptor
containing the address and a view of the buffer.</p>
<p>Explicitly deallocating a buffer is optional; see local_dealloc.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id8">
<h3>Attributes:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>alignment</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id9">
<h3>Operands:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id10">
<h3>Results:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-local-dealloc-triton-gpu-localdeallocop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_dealloc</span></code> (triton::gpu::LocalDeallocOp)<a class="headerlink" href="#triton-gpu-local-dealloc-triton-gpu-localdeallocop" title="Link to this heading">¶</a></h2>
<p><em>Dealloc buffer</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.local_dealloc` $src attr-dict `:` qualified(type($src))
</pre></div>
</div>
<p>This operation deallocates a buffer explicitly. Using the buffer after this
operation is undefined.</p>
<p>This operation is optional.  If you don’t explicitly dealloc a buffer, the
compiler assumes it’s deallocated at the first point that post-dominates all
uses of the alloc.</p>
<p>Because we assume a memdesc is dead at the first point that post-dominates
its uses, ops that wait for an async operation on a memdesc to complete
(such as triton_nvidia_gpu.warp_group_dot_wait) should also take the memdesc as an
operand.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{MemoryEffects::Free</span> <span class="pre">on</span> <span class="pre">::mlir::triton::gpu::SharedMemory}</span></code></p>
<section id="id11">
<h3>Operands:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-local-load-triton-gpu-localloadop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_load</span></code> (triton::gpu::LocalLoadOp)<a class="headerlink" href="#triton-gpu-local-load-triton-gpu-localloadop" title="Link to this heading">¶</a></h2>
<p><em>Load a buffer from local memory into a distributed tensor</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.local_load` $src (`token` $token^)? attr-dict `:` qualified(type($src)) `-&gt;` type($result)
</pre></div>
</div>
<p>Load a tensor from the local memory descriptor into a distributed tensor.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id12">
<h3>Operands:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id13">
<h3>Results:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-local-store-triton-gpu-localstoreop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.local_store</span></code> (triton::gpu::LocalStoreOp)<a class="headerlink" href="#triton-gpu-local-store-triton-gpu-localstoreop" title="Link to this heading">¶</a></h2>
<p><em>Store a distributed tensor into a buffer in local memory</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.local_store` $src `,` $dst attr-dict `:` type($src) `-&gt;` qualified(type($dst))
</pre></div>
</div>
<p>Store a distributed tensor into a buffer in local memory.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">MemoryEffectOpInterface</span></code></p>
<section id="id14">
<h3>Operands:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>ranked tensor of floating-point or integer or ptr values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">dst</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="triton-gpu-memdesc-subview-triton-gpu-memdescsubviewop">
<h2><code class="docutils literal notranslate"><span class="pre">triton_gpu.memdesc_subview</span></code> (triton::gpu::MemDescSubviewOp)<a class="headerlink" href="#triton-gpu-memdesc-subview-triton-gpu-memdescsubviewop" title="Link to this heading">¶</a></h2>
<p><em>Take a subview of the descriptor.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `triton_gpu.memdesc_subview` $src `[` $offsets `]` attr-dict `:` qualified(type($src)) `-&gt;` qualified(type($result))
</pre></div>
</div>
<p>This operation returns a new descriptor representing a subview of the buffer.
It doesn’t affect the underlying memory. The subview can be rank-reduced.</p>
<p>For example, suppose that</p>
<ul class="simple">
<li><p>the input shape is 2x4x16xf16,</p></li>
<li><p>the output shape is 4x4xf16, and</p></li>
<li><p>offsets = [1, 0, 4].</p></li>
</ul>
<p>Then in Python syntax, the subview covers input[1][0:4][4:8].</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">VerifyTensorLayoutsTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id15">
<h3>Operands:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">src</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">offsets</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id16">
<h3>Results:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="TritonDialect.html" class="btn btn-neutral float-left" title="‘tt’ Dialect" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="TritonOps.html" class="btn btn-neutral float-right" title="TritonOps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Philippe Tillet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>